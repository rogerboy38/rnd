{
 "creation": "2025-08-23 14:53:16.399276",
 "docstatus": 0,
 "doctype": "Client Script",
 "dt": "COA AMB2",
 "enabled": 0,
 "idx": 0,
 "modified": "2025-08-23 19:22:31.466499",
 "modified_by": "Administrator",
 "module": "RND",
 "name": "hello_world_test",
 "owner": "Administrator",
 "script": "// CORRECT Client Script for Frappe v15\r\nfrappe.ui.form.on('COA AMB', {\r\n    refresh: function(frm) {\r\n        // Test buttons\r\n        frm.add_custom_button(__('Test Server Script'), function() {\r\n            test_server_script();\r\n        }).addClass('btn-success');\r\n        \r\n        frm.add_custom_button(__('Test TDS Load'), function() {\r\n            test_tds_load(frm);\r\n        }).addClass('btn-primary');\r\n        \r\n        frm.add_custom_button(__('Direct Console Test'), function() {\r\n            direct_console_test();\r\n        }).addClass('btn-info');\r\n    }\r\n});\r\n\r\n// Method 1: Using frappe.call with correct method path\r\nfunction test_server_script() {\r\n    console.group('\ud83e\uddea Testing Server Script');\r\n    console.log('Testing with frappe.call...');\r\n    \r\n    frappe.call({\r\n        method: 'hello_world_test',\r\n        args: {},\r\n        callback: function(r) {\r\n            console.log('Server response:', r);\r\n            \r\n            if (r.message) {\r\n                console.log('\u2705 Response received');\r\n                console.log('Message:', r.message);\r\n                \r\n                if (r.message.success) {\r\n                    frappe.show_alert({\r\n                        message: __('\u2705 {0}', [r.message.message]),\r\n                        indicator: 'green'\r\n                    });\r\n                } else {\r\n                    frappe.msgprint({\r\n                        title: __('Error'),\r\n                        message: __('Server script error: ') + (r.message.message || 'Unknown'),\r\n                        indicator: 'red'\r\n                    });\r\n                }\r\n            } else {\r\n                console.error('\u274c No message in response');\r\n                frappe.msgprint({\r\n                    title: __('Error'),\r\n                    message: __('No response from server script'),\r\n                    indicator: 'red'\r\n                });\r\n            }\r\n            console.groupEnd();\r\n        },\r\n        error: function(err) {\r\n            console.error('\u274c Call error:', err);\r\n            frappe.msgprint({\r\n                title: __('Network Error'),\r\n                message: __('Could not connect to server script. Please check script name and configuration.'),\r\n                indicator: 'red'\r\n            });\r\n            console.groupEnd();\r\n        }\r\n    });\r\n}\r\n\r\n// Method 2: Test TDS loading\r\nfunction test_tds_load(frm) {\r\n    if (!frm.doc.linked_tds) {\r\n        frappe.msgprint(__('Please select a TDS first'));\r\n        return;\r\n    }\r\n    \r\n    frappe.call({\r\n        method: 'load_tds_parameters_api.load_tds_parameters',\r\n        args: {\r\n            coa_name: frm.doc.name || 'test_coa',\r\n            tds_name: frm.doc.linked_tds\r\n        },\r\n        freeze: true,\r\n        freeze_message: __('Loading parameters...'),\r\n        callback: function(r) {\r\n            if (r.message) {\r\n                if (r.message.success) {\r\n                    frappe.show_alert({\r\n                        message: __('\u2705 {0}', [r.message.message]),\r\n                        indicator: 'green'\r\n                    });\r\n                    if (frm.doc.name) {\r\n                        frm.reload_doc();\r\n                    }\r\n                } else {\r\n                    frappe.msgprint({\r\n                        title: __('Error'),\r\n                        message: __('Failed to load parameters: ') + (r.message.message || 'Unknown error'),\r\n                        indicator: 'red'\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n// Method 3: Direct test from console\r\nfunction direct_console_test() {\r\n    // This is the code you can run directly in browser console\r\n    console.log('Running direct test...');\r\n    frappe.call({\r\n        method: 'hello_world_test.hello_world',\r\n        callback: function(r) {\r\n            console.log('Direct test result:', r);\r\n        }\r\n    });\r\n}\r\n\r\n// Method 4: Alternative approach - check if server script exists\r\nfunction check_server_script() {\r\n    frappe.call({\r\n        method: 'frappe.client.get',\r\n        args: {\r\n            doctype: 'Server Script',\r\n            name: 'hello_world_test'\r\n        },\r\n        callback: function(r) {\r\n            if (r.message) {\r\n                console.log('Server script found:', r.message);\r\n                frappe.show_alert({\r\n                    message: __('Server script exists and is {0}', [r.message.disabled ? 'disabled' : 'enabled']),\r\n                    indicator: 'green'\r\n                });\r\n            } else {\r\n                console.log('Server script not found');\r\n                frappe.msgprint({\r\n                    title: __('Not Found'),\r\n                    message: __('Server script \"hello_world_test\" does not exist'),\r\n                    indicator: 'red'\r\n                });\r\n            }\r\n        }\r\n    });\r\n}",
 "view": "Form"
}
